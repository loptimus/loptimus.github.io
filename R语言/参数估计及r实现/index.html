<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-CN"><head><meta charset="UTF-8"><meta name="generator" content="Hexo 3.9.0"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.3.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.3.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.3.0"><link rel="mask-icon" href="/images/logo.svg?v=7.3.0" color="#222"><link rel="stylesheet" href="/css/main.css?v=7.3.0"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.3.0",sidebar:{position:"left",display:"post",offset:12,onmobile:!1},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},copycode:{enable:!1,show_result:!1,style:null},fancybox:!1,mediumzoom:!0,lazyload:!0,pangu:!1,algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},search:{root:"/",path:"search.xml"},tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},translation:{copy_button:"复制",copy_success:"复制成功",copy_failure:"复制失败"}}</script><meta name="description" content="参数估计的R语言实现 概要 简要描述参数估计相关概念，并使用R语言实现参数估计中常用的点估计和区间估计，其中点估计也包含两种常用的方法：矩法估计和极大似然估计。 \[ \begin{cases} \text{点估计}     \begin{cases}     \text{矩法估计} \\     \text{极大似然估计}     \end{cases}\\ \text{区间估计} \end{c"><meta name="keywords" content="数理统计,R语言,点估计,区间估计"><meta property="og:type" content="article"><meta property="og:title" content="参数估计及R实现"><meta property="og:url" content="http://yoursite.com/R语言/参数估计及r实现/index.html"><meta property="og:site_name" content="QuickNotes"><meta property="og:description" content="参数估计的R语言实现 概要 简要描述参数估计相关概念，并使用R语言实现参数估计中常用的点估计和区间估计，其中点估计也包含两种常用的方法：矩法估计和极大似然估计。 \[ \begin{cases} \text{点估计}     \begin{cases}     \text{矩法估计} \\     \text{极大似然估计}     \end{cases}\\ \text{区间估计} \end{c"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2019-08-02T09:14:48.463Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="参数估计及R实现"><meta name="twitter:description" content="参数估计的R语言实现 概要 简要描述参数估计相关概念，并使用R语言实现参数估计中常用的点估计和区间估计，其中点估计也包含两种常用的方法：矩法估计和极大似然估计。 \[ \begin{cases} \text{点估计}     \begin{cases}     \text{矩法估计} \\     \text{极大似然估计}     \end{cases}\\ \text{区间估计} \end{c"><link rel="canonical" href="http://yoursite.com/R语言/参数估计及r实现/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>参数估计及R实现 | QuickNotes</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">QuickNotes</span><span class="logo-line-after"><i></i></span></a></div></div><div class="site-nav-toggle"> <button aria-label="切换导航栏"><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>公益 404</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header> <a href="https://github.com/loptimus" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://yoursite.com/R语言/参数估计及r实现/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lwl"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="QuickNotes"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">参数估计及R实现</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-02-26 18:34:47" itemprop="dateCreated datePublished" datetime="2019-02-26T18:34:47+08:00">2019-02-26</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2019-08-02 17:14:48" itemprop="dateModified" datetime="2019-08-02T17:14:48+08:00">2019-08-02</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R语言/" itemprop="url" rel="index"><span itemprop="name">R语言</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> 阅读次数：<span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span></span><br><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span title="本文字数">20k</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">1 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="参数估计的r语言实现">参数估计的R语言实现</h1><h2 id="概要">概要</h2><p>简要描述参数估计相关概念，并使用R语言实现参数估计中常用的<strong>点估计</strong>和<strong>区间估计</strong>，其中点估计也包含两种常用的方法：<strong>矩法估计</strong>和<strong>极大似然估计</strong>。 <span class="math display">\[ \begin{cases} \text{点估计} \begin{cases} \text{矩法估计} \\ \text{极大似然估计} \end{cases}\\ \text{区间估计} \end{cases} \]</span><a id="more"></a></p><h2 id="参数估计">参数估计</h2><p>参数估计，指对于所研究的总体，在总体分布类型已知情况下，根据样本信息对总体分布中所包含的未知参数进行估计。例如，假设总体<span class="math inline">\(X \sim N(\mu, 1)\)</span>，<span class="math inline">\(\mu\)</span>为未知参数，<span class="math inline">\(x_1,\cdots,x_n\)</span>是来自总体<span class="math inline">\(X\)</span>的一个样本，然后通过样本对未知参数进行估计。参数估计有两种常用的形式，一种叫<strong>点估计</strong>，就是用一个具体的数值去估计一个未知参数；另一种叫<strong>区间估计</strong>，就是要找两个统计量<span class="math inline">\(\widehat{\theta}_L = \widehat{\theta}_L(x_1,\cdots,x_n)\)</span>和<span class="math inline">\(\widehat{\theta}_U = \widehat{\theta}_U(x_1,\cdots,x_n)\)</span>，使得<span class="math inline">\(\widehat{\theta}_L \leq \widehat{\theta}_U\)</span>，在得到样本观测值之后，就把<span class="math inline">\(\theta\)</span>估计在区间<span class="math inline">\([\widehat{\theta}_L, \widehat{\theta}_U]\)</span>。</p><h3 id="点估计">点估计</h3><p>点估计有两种常用方法：<strong>矩法估计</strong>和<strong>极大似然估计</strong>。</p><h4 id="矩法估计">矩法估计</h4><p>矩法估计的基本思想是基于替换原则对参数进行估计，可以理解为使用样本的原点矩（中心矩）替换总体的原点矩（中心矩）对参数进行估计。矩法估计的计算方法如下： 设总体<span class="math inline">\(X\)</span>的分布函数为<span class="math inline">\(F(x;\theta_1,\cdots,\theta_l)\)</span>，其中<span class="math inline">\(\theta_1,\cdots,\theta_l\)</span>为待估参数，<span class="math inline">\(l\)</span>为未知参数个数。设<span class="math inline">\(x_1,\cdots,x_n\)</span>是来自总体<span class="math inline">\(X\)</span>的样本，使用<span class="math display">\[M_k(k = 1, 2,\cdots,l)\]</span>表示<span class="math inline">\(k\)</span>阶样本原点矩（或中心矩）。若总体<span class="math inline">\(X\)</span>的<span class="math inline">\(k(k \geq l)\)</span>阶原点矩（或中心矩）存在，并记为<span class="math inline">\(\mu_k\)</span>，若<span class="math inline">\(\mu_k\)</span>能表示成参数<span class="math inline">\(\theta_1,\cdots,\theta_l\)</span>的函数，即<span class="math display">\[\mu_k = \mu_k(\theta_1,\cdots,\theta_l), (k = 1, 2,\cdots, l)\]</span> 则令前<span class="math inline">\(l\)</span>阶样本原点矩（中心矩）与相应的前<span class="math inline">\(l\)</span>阶总体原点矩（中心矩）相等，这样就得到一个联立方程： <span class="math display">\[ \begin{cases} \mu_1(\theta_1,\cdots,\theta_l) = M_1\\ \mu_2(\theta_1,\cdots,\theta_l) = M_2\\ \qquad\qquad \vdots\\ \mu_l(\theta_1,\cdots,\theta_l) = M_l \end{cases} \]</span> 解方程组可得<span class="math inline">\(\widehat{\theta}_k=\widehat{\theta}_k(x_1, \cdots, x_n), k = 1,2,\cdots,l\)</span>，然后用<span class="math inline">\(\widehat{\theta}_k\)</span>作为<span class="math inline">\(\theta_k\)</span>的估计，即得所有未知参数<span class="math inline">\(\theta_1,\cdots,\theta_l\)</span>的矩法估计。</p><h4 id="r语言实现">R语言实现</h4><p>由矩法估计的计算方法可以看到，矩法估计通过替换原则，最后归结为求解方程组的问题。在R语言中常用的解方程函数有：</p><table><thead><tr class="header"><th>函数</th><th>功能</th><th>程序包</th></tr></thead><tbody><tr class="odd"><td>uniroot</td><td>求解一元（非线性）方程</td><td>stats</td></tr><tr class="even"><td>multiroot</td><td>给定<span class="math inline">\(n\)</span>个（非线性）方程，求解<span class="math inline">\(n\)</span>个根</td><td>rootSolve</td></tr></tbody></table><ul><li>uniroot函数的使用</li></ul><p>函数原型：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uniroot(f, interval, <span class="keyword">...</span>,</span><br><span class="line">        lower = min(interval), upper = max(interval),</span><br><span class="line">        f.lower = f(lower, <span class="keyword">...</span>), f.upper = f(upper, <span class="keyword">...</span>),</span><br><span class="line">        extendInt = c(<span class="string">"no"</span>, <span class="string">"yes"</span>, <span class="string">"downX"</span>, <span class="string">"upX"</span>), check.conv = <span class="literal">FALSE</span>,</span><br><span class="line">        tol = .Machine$double.eps^<span class="number">0.25</span>, maxiter = <span class="number">1000</span>, trace = <span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>其中主要参数含义如下:</p><table><thead><tr class="header"><th>参数</th><th>含义</th></tr></thead><tbody><tr class="odd"><td>f</td><td>要求解的方程的函数</td></tr><tr class="even"><td>interval</td><td>数值向量，要求解的根的搜索区间</td></tr><tr class="odd"><td>...</td><td>传递给第一个参数f函数的参数</td></tr><tr class="even"><td>lower</td><td>min(interval)，搜索区间的左端点</td></tr><tr class="odd"><td>upper</td><td>max(interval)，搜索区间的右端点</td></tr><tr class="even"><td>tol</td><td>所需精度</td></tr><tr class="odd"><td>maxiter</td><td>最大迭代次数</td></tr></tbody></table><ul><li>multiroot函数求解方程组</li></ul><p>函数原型：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">multiroot(f, start, maxiter = <span class="number">100</span>, </span><br><span class="line">          rtol = <span class="number">1e-6</span>, atol = <span class="number">1e-8</span>, ctol = <span class="number">1e-8</span>, </span><br><span class="line">          useFortran = <span class="literal">TRUE</span>, positive = <span class="literal">FALSE</span>,</span><br><span class="line">          jacfunc = <span class="literal">NULL</span>, jactype = <span class="string">"fullint"</span>,</span><br><span class="line">          verbose = <span class="literal">FALSE</span>, bandup = <span class="number">1</span>, banddown = <span class="number">1</span>, </span><br><span class="line">          parms = <span class="literal">NULL</span>, <span class="keyword">...</span>)</span><br></pre></td></tr></table></figure><p>这里所用到的参数及其含义如下：</p><table><thead><tr class="header"><th>参数</th><th>含义</th></tr></thead><tbody><tr class="odd"><td>f</td><td>所要求解的方程的函数</td></tr><tr class="even"><td>start</td><td>给定根的初始值</td></tr></tbody></table><p>例：设总体<span class="math inline">\(X\)</span>服从均匀分布<span class="math inline">\(U(a, b)\)</span>，其中<span class="math inline">\(a\)</span>，<span class="math inline">\(b\)</span>为未知参数，从总体<span class="math inline">\(X\)</span>中获得容量为<span class="math inline">\(n=5\)</span>的样本：<span class="math inline">\((x_1 = 4.5，x_2 = 5.0，x_3 = 4.7，x_4 = 4.0，x_5 = 4.2)\)</span>，求参数<span class="math inline">\(a\)</span>，<span class="math inline">\(b\)</span>的矩估计<span class="math inline">\(\widehat{a}, \widehat{b}\)</span>。</p><p>解：因为有<span class="math inline">\(a\)</span>，<span class="math inline">\(b\)</span>两个未知参数，所以令阶矩<span class="math inline">\(k = 2\)</span>。已知1阶样本原点矩（样本均值）<span class="math inline">\(M_1 = \overline{x} = \frac{1}{n}\sum_{i=1}^n x_i\)</span>，2阶样本中心矩（样本方差）<span class="math inline">\(M_2 = s^2 = \frac{1}{n - 1}\sum_{i = 1}^n (x_i - \overline{x})^2\)</span>，由于1阶原点矩（期望）<span class="math inline">\(\mu_1 = \frac{a + b}{2}\)</span>，2阶中心矩（方差）<span class="math inline">\(\mu_2 = \frac{(b - a)^2}{12}\)</span>，所以得到联立方程组： <span class="math display">\[ \begin{cases} \frac{a + b}{2} = \overline{x}\\ \frac{(b - a)^2}{12} = s^2 \end{cases} \]</span> 使用multiroot求解方程组求时，需先安装R包rootSolve</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"rootSolve"</span>)</span><br></pre></td></tr></table></figure><p>安装完成后，即可使用multiroot函数求解方程组。需要注意的是，multiroot函数的第一个参数f要求求解的方程组的函数值为0的根。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(rootSolve)  <span class="comment"># 载入rootSolve</span></span><br><span class="line">x &lt;- c(<span class="number">4.5</span>，<span class="number">5.0</span>，<span class="number">4.7</span>，<span class="number">4.0</span>，<span class="number">4.2</span>)</span><br><span class="line">mean &lt;- mean(x)  <span class="comment"># 样本均值</span></span><br><span class="line">var &lt;- var(x)    <span class="comment"># 样本方差</span></span><br><span class="line">model &lt;- <span class="keyword">function</span>(theta, mean, var)&#123;</span><br><span class="line"> <span class="comment"># 方程组向量</span></span><br><span class="line">c(f1 = (theta[<span class="number">1</span>] + theta[<span class="number">2</span>]) / <span class="number">2</span> - mean, f2 = (theta[<span class="number">2</span>] - theta[<span class="number">1</span>])^<span class="number">2</span>/<span class="number">12</span>-var)  </span><br><span class="line">&#125;                <span class="comment"># 求解方程组的函数</span></span><br><span class="line"><span class="comment"># 使用multiroot求解方程组, 参数mean，var会传递到model函数对应的mean,var中</span></span><br><span class="line">multiroot(f = model, start = c(<span class="number">0</span>,<span class="number">10</span>), mean = mean, var = var)</span><br></pre></td></tr></table></figure><p>输出结果：</p><p></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$root</span><br><span class="line">[<span class="number">1</span>] <span class="number">3.793706</span> <span class="number">5.166294</span> </span><br><span class="line">$f.root</span><br><span class="line">f1            f2 </span><br><span class="line">-<span class="number">1.580958e-13</span>  <span class="number">7.194056e-11</span>  </span><br><span class="line">$iter</span><br><span class="line">[<span class="number">1</span>] <span class="number">6</span></span><br><span class="line">$estim.precis</span><br><span class="line">[<span class="number">1</span>] <span class="number">3.604933e-11</span></span><br></pre></td></tr></table></figure><p></p><p>第一行$root给出的输出结果就是所求的参数估计值<span class="math inline">\(\widehat{a} = 3.793706, \widehat{b}=5.166294\)</span>。</p><h3 id="极大似然估计">极大似然估计</h3><p>极大似然估计本质上是对似然函数关于未知参数求最大值问题，所求出的极大值就作为相应未知参数的极大似然估计。</p><ul><li><p>概率函数</p><p>设<span class="math inline">\(X\)</span>是一个连续型或离散型随机变量，其<strong>概率函数</strong>定义为</p></li></ul><p><span class="math display">\[ p(x) = \begin{cases} P(X = x), &amp; X为离散型随机变量，P(X = x)为X分布列;\\ f(x), &amp; X为连续型随机变量，f(x)为X的密度函数 \end{cases} \]</span></p><ul><li><p>似然函数</p><p>设<span class="math inline">\(x_1,\cdots,x_n\)</span>是来自总体<span class="math inline">\(X\)</span>的样本，<span class="math inline">\(X\)</span>的概率函数为<span class="math inline">\(p(x;\theta)\)</span>，其中参数<span class="math inline">\(\theta \in \Theta\)</span>，<span class="math inline">\(\Theta\)</span>为参数空间。样本<span class="math inline">\((x_1,\cdots,x_n)\)</span>的联合概率函数<span class="math display">\[p(x_1;\theta)p(x_2;\theta)\cdots p(x_n;\theta)\]</span>作为<span class="math inline">\(\theta\)</span>函数，称其为<strong>似然函数</strong>，记为<span class="math inline">\(L(\theta) = L(\theta;x_1,\cdots,x_n)\)</span>，即<span class="math display">\[L(\theta) = L(\theta;x_1,\cdots,x_n) = p(x_1;\theta)p(x_2;\theta)\cdots p(x_n;\theta)\]</span></p></li><li><p>极大似然估计</p><p>若<span class="math inline">\(\widehat{\theta}(x_1, \cdots, x_n)\)</span>是一个统计量，满足条件<span class="math display">\[L(\widehat{\theta};x_1,\cdots,x_n) = max_{\theta \in \Theta}L(\theta;x_1,\cdots,x_n)\]</span></p><p>则称<span class="math inline">\(\widehat{\theta}(x_1, \cdots, x_n)\)</span>是<span class="math inline">\(\theta\)</span>的<strong>极大似然估计</strong>，简称MLE。</p></li></ul><h4 id="r语言实现-1">R语言实现</h4><p><strong>例</strong>：已知在文学家萧伯纳的&lt;&lt;An Intelligent Woman's Guide To Socialism&gt;&gt;一书中，一个句子的单词数<span class="math inline">\(X\)</span>近似服从对数正态分布，即<span class="math inline">\(Z = ln X \sim N(\mu, \sigma^2)\)</span>。现从该书中随机地取20个句子，这些句子中的单词数分别为：52, 24, 15, 67, 15, 22, 63, 26, 16, 32, 7, 33, 28, 14, 7, 29, 10, 6, 59, 30。求该书中一个句子单词数均值<span class="math inline">\(E(X) = e^{\mu + \sigma^2/2}\)</span>的最大似然估计</p><ul><li><p>nlminb函数</p><p>nlminb函数时非线性最小化函数。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">52</span>, <span class="number">24</span>, <span class="number">15</span>, <span class="number">67</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">63</span>, <span class="number">26</span>, <span class="number">16</span>, <span class="number">32</span>, </span><br><span class="line">       <span class="number">7</span>, <span class="number">33</span>, <span class="number">28</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">29</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">59</span>, <span class="number">30</span>)   <span class="comment"># 样本</span></span><br><span class="line"></span><br><span class="line">lfun &lt;- <span class="keyword">function</span>(para)&#123;   <span class="comment"># 似然函数</span></span><br><span class="line">  f &lt;- dlnorm(x, para[<span class="number">1</span>], para[<span class="number">2</span>])</span><br><span class="line">  logfun &lt;- sum(log(f))  <span class="comment"># 使用对数函数进行求极值</span></span><br><span class="line">  <span class="keyword">return</span>(-logfun)        <span class="comment"># 因为nlminb求的是极小值，所以应返回相反数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">start &lt;- c(<span class="number">3</span>, <span class="number">3</span>)  <span class="comment"># 参数求解的初始值</span></span><br><span class="line">lower &lt;- c(<span class="number">0.0001</span>, <span class="number">0.0001</span>)  <span class="comment"># 参数取值范围下界</span></span><br><span class="line">upper &lt;- c(<span class="literal">Inf</span>, <span class="literal">Inf</span>) <span class="comment"># 参数取值范围上界</span></span><br><span class="line">para &lt;- nlminb(lfun, start = start, lower = lower, upper = upper)  <span class="comment"># 求似然函数极值</span></span><br><span class="line">c(mu &lt;- para$par[<span class="number">1</span>], sigma &lt;- para$par[<span class="number">2</span>], exp(mu + sigma^<span class="number">2</span> / <span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>]  <span class="number">3.0890327</span>  <span class="number">0.7128333</span> <span class="number">28.3066946</span></span><br></pre></td></tr></table></figure><p>第1、2个输出结果分别为<span class="math inline">\(\mu\)</span>、<span class="math inline">\(\sigma\)</span>的极大似然估计，<span class="math inline">\(\widehat{\mu} = 3.0890327\)</span>，<span class="math inline">\(\widehat{\sigma} = 0.7128333\)</span>；由<strong>极大似然估计不变性</strong>可知，所求该书中一个句子单词数均值的极大似然估计<span class="math inline">\(E(X) = e^{\mu + \sigma^2/2} = 28.3066959\)</span></p><blockquote><p><strong>极大似然估计不变性</strong>：如果<span class="math inline">\(\widehat{\theta}\)</span>是<span class="math inline">\(\theta\)</span>的极大似然估计，则对任一函数<span class="math inline">\(g(\theta)\)</span>，其最大似然估计为<span class="math inline">\(g(\widehat{\theta})\)</span>。</p></blockquote></li><li><p>maxLik函数</p><p>maxLik函数在maxLik包中，maxLik函数使用简单，而且即使在初始值偏离较大的情况下，计算得到的估计值也非常接近真值，计算准确度较高。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">52</span>, <span class="number">24</span>, <span class="number">15</span>, <span class="number">67</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">63</span>, <span class="number">26</span>, <span class="number">16</span>, <span class="number">32</span>, </span><br><span class="line">       <span class="number">7</span>, <span class="number">33</span>, <span class="number">28</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">29</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">59</span>, <span class="number">30</span>)   <span class="comment"># 样本</span></span><br><span class="line"></span><br><span class="line">lfun &lt;- <span class="keyword">function</span>(para)&#123;   <span class="comment"># 似然函数</span></span><br><span class="line">  f &lt;- dlnorm(x, para[<span class="number">1</span>], para[<span class="number">2</span>])</span><br><span class="line">  logfun &lt;- sum(log(f))  <span class="comment"># 使用对数函数进行求极值</span></span><br><span class="line">  <span class="keyword">return</span>(logfun)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">start &lt;- c(<span class="number">3</span>, <span class="number">3</span>)  <span class="comment"># 参数求解的初始值</span></span><br><span class="line">para &lt;- maxLik(lfun, start = start)$estimate  <span class="comment"># 求似然函数极值</span></span><br><span class="line">c(mu &lt;- para[<span class="number">1</span>], sigma &lt;- para[<span class="number">2</span>], exp(mu + sigma^<span class="number">2</span> / <span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>]  <span class="number">3.0890327</span>  <span class="number">0.7128333</span> <span class="number">28.3066946</span></span><br></pre></td></tr></table></figure><p>第1、2个输出结果分别为<span class="math inline">\(\mu\)</span>、<span class="math inline">\(\sigma\)</span>的极大似然估计，<span class="math inline">\(\widehat{\mu} = 3.0890327\)</span>，<span class="math inline">\(\widehat{\sigma} = 0.7128332\)</span>；由<strong>极大似然估计不变性</strong>可知，所求​该书中一个句子单词数均值的极大似然估计<span class="math inline">\(E(X) = e^{\mu + \sigma^2/2} = 28.3066928\)</span>。</p></li></ul><h2 id="区间估计">区间估计</h2><h3 id="单个正态总体参数的置信区间">单个正态总体参数的置信区间</h3><p>设<span class="math inline">\(x_1,\cdots,x_n\)</span>是来自总体<span class="math inline">\(X \sim N(\mu, \sigma^2)\)</span>的样本，样本容量为<span class="math inline">\(n\)</span>，<span class="math inline">\(\overline{x}\)</span>为样本均值，<span class="math inline">\(s^2\)</span>为样本方差。</p><h4 id="方差sigma已知估计期望mu的置信区间">方差<span class="math inline">\(\sigma\)</span>已知，估计期望<span class="math inline">\(\mu\)</span>的置信区间</h4><p>在置信水平为<span class="math inline">\(1-\alpha\)</span>的情况下，<span class="math inline">\(u = \frac{\overline{x} - \mu}{\sigma / \sqrt{n}} \sim N(0, 1)\)</span>，期望<span class="math inline">\(\mu\)</span>的置信区间为<span class="math display">\[[\overline{x} - u_{1-\frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}}, \quad \overline{x} + u_{1-\frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}}]\]</span></p><p>其中<span class="math inline">\(u_{1 - \frac{\alpha}{2}}\)</span>为标准正态分布<span class="math inline">\(N(0, 1)\)</span>的<span class="math inline">\(1 - \frac{\alpha}{2}\)</span>分位数。</p><p><strong>例</strong>：0.5，1.25，0.8，2是取自总体<span class="math inline">\(X\)</span>的样本，已知<span class="math inline">\(Y = ln X \sim N(\mu, 1)\)</span>，求<span class="math inline">\(\mu\)</span>的置信水平为0.95%的置信区间。</p><p>解：由题意，对<span class="math inline">\(X\)</span>的样本求对数，得到<span class="math inline">\(Y\)</span>样本，然后使用<span class="math inline">\(Y\)</span>的样本根据分布条件计算置信区间</p><ul><li>自定义函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sample &lt;- c(<span class="number">0.5</span>, <span class="number">1.25</span>, <span class="number">0.8</span>, <span class="number">2</span>)</span><br><span class="line">x &lt;- log(sample) <span class="comment"># 样本</span></span><br><span class="line"><span class="comment"># 参数x为样本，sigma为已知的总体标准差，alpha为显著性水平</span></span><br><span class="line">conf.int &lt;- <span class="keyword">function</span>(x, sigma, alpha = <span class="number">0.05</span>)&#123;</span><br><span class="line">  mean &lt;- mean(x)</span><br><span class="line">  n &lt;- length(x)</span><br><span class="line">  z &lt;- qnorm(p = <span class="number">1</span>-alpha/<span class="number">2</span>, lower.tail = <span class="literal">TRUE</span>)</span><br><span class="line">  c(mean - z * sigma / sqrt(n), mean + z * sigma / sqrt(n))</span><br><span class="line">&#125;</span><br><span class="line">conf.int(x, sigma = <span class="number">1</span>, alpha = <span class="number">0.05</span>) <span class="comment"># 置信水平1 - 0.05 = 0.95</span></span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] -<span class="number">0.979982</span>  <span class="number">0.979982</span></span><br></pre></td></tr></table></figure><p>求得<span class="math inline">\(\mu\)</span>的置信水平为0.95%的置信区间为<span class="math inline">\([-0.979982,0.979982]\)</span></p><ul><li>BSDA包的z.test函数</li></ul><p>BSDA（Basic Statistics and Data Analysis）称为基本统计和数据分析程序包。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"BSDA"</span>) <span class="comment"># 安装BSDA包，若已安装，则注释此行</span></span><br><span class="line"><span class="keyword">library</span>(BSDA) <span class="comment"># 加载BSDA包</span></span><br><span class="line">sample &lt;- c(<span class="number">0.5</span>, <span class="number">1.25</span>, <span class="number">0.8</span>, <span class="number">2</span>)</span><br><span class="line">x &lt;- log(sample) <span class="comment"># 样本</span></span><br><span class="line">ret &lt;- z.test(x, sigma.x = <span class="number">1</span>) <span class="comment"># 默认置信水平为0.95</span></span><br><span class="line">ret$conf.int                      <span class="comment"># 置信区间</span></span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] -<span class="number">0.979982</span>  <span class="number">0.979982</span></span><br><span class="line">attr(,<span class="string">"conf.level"</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.95</span></span><br></pre></td></tr></table></figure><p>求得<span class="math inline">\(\mu\)</span>的置信水平为0.95%的置信区间为<span class="math inline">\([-0.979982,0.979982]\)</span>，conf.level属性显示的就是置信水平0.95。</p><ul><li>UsingR包的simple.z.test函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"UsingR"</span>) <span class="comment"># 安装UsingR包，若已安装，则注释此行</span></span><br><span class="line"><span class="keyword">library</span>(UsingR) <span class="comment"># 加载Using包</span></span><br><span class="line">sample &lt;- c(<span class="number">0.5</span>, <span class="number">1.25</span>, <span class="number">0.8</span>, <span class="number">2</span>)</span><br><span class="line">x &lt;- log(sample) <span class="comment"># 样本</span></span><br><span class="line">simple.z.test(x, sigma = <span class="number">1</span>) <span class="comment"># 默认置信水平为0.95</span></span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] -<span class="number">0.979982</span>  <span class="number">0.979982</span></span><br></pre></td></tr></table></figure><p>求得<span class="math inline">\(\mu\)</span>的置信水平为0.95%的置信区间为<span class="math inline">\([-0.979982,0.979982]\)</span>。</p><h4 id="方差sigma未知估计期望mu的置信区间">方差<span class="math inline">\(\sigma\)</span>未知，估计期望<span class="math inline">\(\mu\)</span>的置信区间</h4><p>在置信水平为<span class="math inline">\(1-\alpha\)</span>的情况下，<span class="math inline">\(\frac{\overline{x} - \mu}{s / \sqrt{n}} \sim t(n - 1)\)</span>，<span class="math inline">\(\mu\)</span>的置信区间为<span class="math display">\[[\overline{x} - t_{1 - \frac{\alpha}{2}}(n-1)\frac{s}{\sqrt n}, \quad \overline{x} + t_{1 - \frac{\alpha}{2}}(n-1)\frac{s}{\sqrt n}]\]</span></p><p>其中<span class="math inline">\(t_{1 - \frac{\alpha}{2}}\)</span>为<span class="math inline">\(t(n-1)\)</span>分布的<span class="math inline">\(1 - \frac{\alpha}{2}\)</span>分位数。</p><p><strong>例</strong>：假设轮胎的寿命服从正态分布。为估计某种轮胎的平均寿命，现随机地抽取12只轮胎试用，测得它们的寿命（单位：万公里）如下：4.68, 4.85, 4.32, 4.85, 4.61, 5.02, 5.20, 4.60, 4.58, 4.72, 4.38, 4.70，试求平均寿命的0.95置信区间。</p><ul><li>自定义函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">4.68</span>, <span class="number">4.85</span>, <span class="number">4.32</span>, <span class="number">4.85</span>, <span class="number">4.61</span>, <span class="number">5.02</span>, <span class="number">5.20</span>, <span class="number">4.60</span>, <span class="number">4.58</span>, <span class="number">4.72</span>, <span class="number">4.38</span>, <span class="number">4.70</span>) <span class="comment"># 样本</span></span><br><span class="line">conf.int &lt;- <span class="keyword">function</span>(x, alpha = <span class="number">0.05</span>)&#123;</span><br><span class="line">  n &lt;- length(x) <span class="comment"># 样本容量</span></span><br><span class="line">  df &lt;- n - <span class="number">1</span> <span class="comment"># 自由度</span></span><br><span class="line">  mean &lt;- mean(x) <span class="comment"># 样本均值</span></span><br><span class="line">  s &lt;- sd(x) <span class="comment"># 样本标准差</span></span><br><span class="line">  quan &lt;- qt(p = <span class="number">1</span> - alpha / <span class="number">2</span>, df = df) <span class="comment"># t(n-1)分布的1 - alpha/2分位数</span></span><br><span class="line">  min &lt;- mean - quan * s / sqrt(n)</span><br><span class="line">  max &lt;- mean + quan * s / sqrt(n)</span><br><span class="line">  c(min, max)</span><br><span class="line">&#125;</span><br><span class="line">conf.int(x, alpha = <span class="number">0.5</span>) <span class="comment"># 置信水平1 - 0.05 = 0.95</span></span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">4.551601</span> <span class="number">4.866732</span></span><br></pre></td></tr></table></figure><p>求平均寿命的0.95置信区间为<span class="math inline">\([4.551601, 4.866732]\)</span></p><ul><li>t.test函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">4.68</span>, <span class="number">4.85</span>, <span class="number">4.32</span>, <span class="number">4.85</span>, <span class="number">4.61</span>, <span class="number">5.02</span>, <span class="number">5.20</span>, <span class="number">4.60</span>, <span class="number">4.58</span>, <span class="number">4.72</span>, <span class="number">4.38</span>, <span class="number">4.70</span>) <span class="comment"># 样本</span></span><br><span class="line">ret &lt;- t.test(x, conf.level = <span class="number">0.95</span>) <span class="comment"># 置信水平0.95</span></span><br><span class="line">ret$conf.int</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">4.551601</span> <span class="number">4.866732</span></span><br><span class="line">attr(,<span class="string">"conf.level"</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.95</span></span><br></pre></td></tr></table></figure><p>求平均寿命的0.95置信区间为<span class="math inline">\([4.551601, 4.866732]\)</span></p><h4 id="期望mu未知估计方差sigma2的置信区间">期望<span class="math inline">\(\mu\)</span>未知，估计方差<span class="math inline">\(\sigma^2\)</span>的置信区间</h4><p>在置信水平为<span class="math inline">\(1-\alpha\)</span>的情况下，<span class="math inline">\(\frac{(n - 1)s^2}{\sigma^2} \sim \chi^2(n - 1)\)</span>，<span class="math inline">\(\sigma^2\)</span>的置信区间为<span class="math display">\[[\frac{(n - 1)s^2}{\chi_{1-\frac{\alpha}{2}}^2(n - 1)}, \quad \frac{(n - 1)s^2}{\chi_{\frac{\alpha}{2}}^2(n - 1)}]\]</span></p><p>其中<span class="math inline">\(\chi_{\frac{\alpha}{2}}\)</span>，<span class="math inline">\(\chi_{1 - \frac{\alpha}{2}}\)</span>分别为<span class="math inline">\(\chi^2(n - 1)\)</span>分布的<span class="math inline">\(\frac{\alpha}{2}\)</span>，<span class="math inline">\(1 - \frac{\alpha}{2}\)</span>分位数。</p><p><strong>例</strong>：某厂生产的零件重量服从正态分布<span class="math inline">\(N(\mu, \sigma^2)\)</span>，现从该厂生产的零件中抽取9个，测得其质量为（单位：g）：45.3, 45.4, 45.1, 45.3, 45.5, 45.7, 45.4, 45.3, 45.6，试求总体标准差<span class="math inline">\(\sigma\)</span>的0.95置信区间。</p><ul><li>自定义函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">45.3</span>, <span class="number">45.4</span>, <span class="number">45.1</span>, <span class="number">45.3</span>, <span class="number">45.5</span>, <span class="number">45.7</span>, <span class="number">45.4</span>, <span class="number">45.3</span>, <span class="number">45.6</span>)</span><br><span class="line"><span class="comment"># 默认置信水平为1 - 0.05 = 0.95</span></span><br><span class="line">conf.int &lt;- <span class="keyword">function</span>(x, alpha = <span class="number">0.05</span>)&#123;</span><br><span class="line">  n &lt;- length(x) <span class="comment"># 样本容量</span></span><br><span class="line">  df &lt;- n - <span class="number">1</span>  <span class="comment"># 自由度</span></span><br><span class="line">  varSample &lt;- var(x) <span class="comment"># 样本方差</span></span><br><span class="line">  min &lt;- df * varSample / qchisq(<span class="number">1</span> - alpha / <span class="number">2</span>, df = df)</span><br><span class="line">  max &lt;- df * varSample / qchisq(alpha / <span class="number">2</span>, df = df)</span><br><span class="line">  c(min, max)</span><br><span class="line">&#125;</span><br><span class="line">conf.int(x)</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">0.01482787</span> <span class="number">0.11928079</span></span><br></pre></td></tr></table></figure><p>求总体标准差<span class="math inline">\(\sigma\)</span>的0.95置信区间为<span class="math inline">\([0.01482787 0.11928079]\)</span>。</p><h3 id="两个正态总体下的置信区间">两个正态总体下的置信区间</h3><p>设<span class="math inline">\(x_1,\cdots,x_m\)</span>是来自<span class="math inline">\(N(\mu_1, \sigma_1^2)\)</span>的样本，<span class="math inline">\(y_1,\cdots,y_n\)</span>是来自<span class="math inline">\(N(\mu_2, \sigma_2^2)\)</span>的样本，且两个样本相互独立。<span class="math inline">\(\overline{x}\)</span>和<span class="math inline">\(\overline{y}\)</span>分别是它们的样本均值，<span class="math inline">\(s_x^2 = \frac{1}{m-1}\sum_{i=1}^m(x_i - \overline{x})^2\)</span>和<span class="math inline">\(s_y^2 = \frac{1}{n-1}\sum_{i=1}^n(y_i - \overline{y})^2\)</span>分别是它们的样本方差。</p><p><strong>例</strong>：假设某零售公司延长营业时间前后27个典型周的周销售额数据（以万元为单位）为：</p><p>延长之前：67.90, 76.12, 68.64, 74.94, 63.32, 50.43, 44.92, 64.59, 61.68, 65.01, 55.90, 54.88, 46.78, 55.54, 67.90, 71.62, 63.00, 59.50, 63.20, 64.86, 59.32, 53.45, 62.51, 48.78, 53.55, 59.57, 58.62</p><p>延长之后：86.10, 71.13, 116.25, 102.60, 97.51, 65.39, 69.56, 70.80, 83.46, 87.27, 89.83, 80.51, 76.78, 71.11, 90.22, 87.55, 87.60, 90.08, 101.80, 84.96, 97.69, 66.39, 104.06, 72.98, 72.19, 91.01, 84.36</p><p>又假设销售额样本服从正态分布，且满足延长之前<span class="math inline">\(Y \sim N(\mu_1, 8)\)</span>，延长之后<span class="math inline">\(X \sim N(\mu_2, 12)\)</span>。</p><p>####<span class="math inline">\(\sigma_1^2\)</span>和<span class="math inline">\(\sigma_2^2\)</span>已知，估计<span class="math inline">\(\mu_1 - \mu_2\)</span>的置信区间</p><p>在置信水平为<span class="math inline">\(1-\alpha\)</span>的情况下，<span class="math inline">\(\frac{\overline{x} - \overline{y} - (\mu_1 - \mu_2)}{\sqrt{\frac{\sigma_1^2}{m} + \frac{\sigma_2^2}{n}}} \sim N(0, 1)\)</span>，<span class="math inline">\(\mu_1 - \mu_2\)</span>的置信区间为<span class="math display">\[[\overline{x} - \overline{y} - u_{1 - \frac{\alpha}{2}}\sqrt{\frac{\sigma_1^2}{m} + \frac{\sigma_2^2}{n}}, \quad \overline{x} - \overline{y} + u_{1 - \frac{\alpha}{2}}\sqrt{\frac{\sigma_1^2}{m} + \frac{\sigma_2^2}{n}}]\]</span></p><p>其中<span class="math inline">\(u_{1 - \frac{\alpha}{2}}\)</span>为标准正态分布<span class="math inline">\(N(0, 1)\)</span>的<span class="math inline">\(1 - \frac{\alpha}{2}\)</span>分位数。</p><p>用零售公司的例子，求置信水平为0.95时，<span class="math inline">\(\mu_1 - \mu_2\)</span>的置信区间。</p><ul><li>自定义函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">86.10</span>, <span class="number">71.13</span>, <span class="number">116.25</span>, <span class="number">102.60</span>, <span class="number">97.51</span>, <span class="number">65.39</span>, <span class="number">69.56</span>, <span class="number">70.80</span>, </span><br><span class="line">       <span class="number">83.46</span>, <span class="number">87.27</span>, <span class="number">89.83</span>, <span class="number">80.51</span>, <span class="number">76.78</span>, <span class="number">71.11</span>, <span class="number">90.22</span>, <span class="number">87.55</span>, </span><br><span class="line">       <span class="number">87.60</span>, <span class="number">90.08</span>, <span class="number">101.80</span>, <span class="number">84.96</span>, <span class="number">97.69</span>, <span class="number">66.39</span>, <span class="number">104.06</span>, <span class="number">72.98</span>, </span><br><span class="line">       <span class="number">72.19</span>, <span class="number">91.01</span>, <span class="number">84.36</span>) <span class="comment"># 延长营业时间后的销售额样本</span></span><br><span class="line">y &lt;- c(<span class="number">67.90</span>, <span class="number">76.12</span>, <span class="number">68.64</span>, <span class="number">74.94</span>, <span class="number">63.32</span>, <span class="number">50.43</span>, <span class="number">44.92</span>, <span class="number">64.59</span>, </span><br><span class="line">       <span class="number">61.68</span>, <span class="number">65.01</span>, <span class="number">55.90</span>, <span class="number">54.88</span>, <span class="number">46.78</span>, <span class="number">55.54</span>, <span class="number">67.90</span>, <span class="number">71.62</span>, </span><br><span class="line">       <span class="number">63.00</span>, <span class="number">59.50</span>, <span class="number">63.20</span>, <span class="number">64.86</span>, <span class="number">59.32</span>, <span class="number">53.45</span>, <span class="number">62.51</span>, <span class="number">48.78</span>, </span><br><span class="line">       <span class="number">53.55</span>, <span class="number">59.57</span>, <span class="number">58.62</span>) <span class="comment"># 延长营业时间前的销售额样本</span></span><br><span class="line"><span class="comment"># 置信水平1 - 0.05 = 0.95</span></span><br><span class="line">conf.int &lt;- <span class="keyword">function</span>(x, y, sigma.x, sigma.y, alpha = <span class="number">0.05</span>)&#123;</span><br><span class="line">  m &lt;- length(x) <span class="comment"># 样本x的容量</span></span><br><span class="line">  n &lt;- length(y) <span class="comment"># 样本y的容量</span></span><br><span class="line">  mean.x &lt;- mean(x) <span class="comment"># 样本x的均值</span></span><br><span class="line">  mean.y &lt;- mean(y) <span class="comment"># 样本y的均值</span></span><br><span class="line">  quan &lt;- qnorm(<span class="number">1</span> - alpha / <span class="number">2</span>) <span class="comment"># 标准正态分布的1 - alpha/2分位数</span></span><br><span class="line">  min &lt;- mean.x - mean.y - quan * sqrt(sigma.x^<span class="number">2</span> / m + sigma.y^<span class="number">2</span> / n)</span><br><span class="line">  max &lt;- mean.x - mean.y + quan * sqrt(sigma.x^<span class="number">2</span> / m + sigma.y^<span class="number">2</span> / n)</span><br><span class="line">  c(min, max)</span><br><span class="line">&#125;</span><br><span class="line">conf.int(x, y, <span class="number">12</span>, <span class="number">8</span>)</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">19.10298</span> <span class="number">29.98295</span></span><br></pre></td></tr></table></figure><ul><li>z.test函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"BSDA"</span>) <span class="comment"># 安装BSDA包，若已安装，则注释此行</span></span><br><span class="line"><span class="keyword">library</span>(BSDA)</span><br><span class="line">x &lt;- c(<span class="number">86.10</span>, <span class="number">71.13</span>, <span class="number">116.25</span>, <span class="number">102.60</span>, <span class="number">97.51</span>, <span class="number">65.39</span>, <span class="number">69.56</span>, <span class="number">70.80</span>, </span><br><span class="line">       <span class="number">83.46</span>, <span class="number">87.27</span>, <span class="number">89.83</span>, <span class="number">80.51</span>, <span class="number">76.78</span>, <span class="number">71.11</span>, <span class="number">90.22</span>, <span class="number">87.55</span>, </span><br><span class="line">       <span class="number">87.60</span>, <span class="number">90.08</span>, <span class="number">101.80</span>, <span class="number">84.96</span>, <span class="number">97.69</span>, <span class="number">66.39</span>, <span class="number">104.06</span>, <span class="number">72.98</span>, </span><br><span class="line">       <span class="number">72.19</span>, <span class="number">91.01</span>, <span class="number">84.36</span>) <span class="comment"># 延长营业时间后的销售额样本</span></span><br><span class="line">y &lt;- c(<span class="number">67.90</span>, <span class="number">76.12</span>, <span class="number">68.64</span>, <span class="number">74.94</span>, <span class="number">63.32</span>, <span class="number">50.43</span>, <span class="number">44.92</span>, <span class="number">64.59</span>, </span><br><span class="line">       <span class="number">61.68</span>, <span class="number">65.01</span>, <span class="number">55.90</span>, <span class="number">54.88</span>, <span class="number">46.78</span>, <span class="number">55.54</span>, <span class="number">67.90</span>, <span class="number">71.62</span>, </span><br><span class="line">       <span class="number">63.00</span>, <span class="number">59.50</span>, <span class="number">63.20</span>, <span class="number">64.86</span>, <span class="number">59.32</span>, <span class="number">53.45</span>, <span class="number">62.51</span>, <span class="number">48.78</span>, </span><br><span class="line">       <span class="number">53.55</span>, <span class="number">59.57</span>, <span class="number">58.62</span>) <span class="comment"># 延长营业时间前的销售额样本</span></span><br><span class="line">ret &lt;- z.test(x, y, sigma.x = <span class="number">12</span>, sigma.y = <span class="number">8</span>) <span class="comment"># 默认置信水平为0.95</span></span><br><span class="line">ret$conf.int</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">19.10298</span> <span class="number">29.98295</span></span><br><span class="line">attr(,<span class="string">"conf.level"</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.95</span></span><br></pre></td></tr></table></figure><p>求得置信区间的结果为<span class="math inline">\([19.10298, 29.98295]\)</span>。所得的置信区间结果说明，零售公司延长营业时间后，周营业额明显增加，在0.95的置信水平下，营业额增加的范围是<span class="math inline">\([19.10298, 29.98295]\)</span>。</p><h4 id="方差sigma_12-sigma_22-sigma2未知估计mu_1---mu_2的置信区间">方差<span class="math inline">\(\sigma_1^2 = \sigma_2^2 = \sigma^2\)</span>未知，估计<span class="math inline">\(\mu_1 - \mu_2\)</span>的置信区间</h4><p>在置信水平为<span class="math inline">\(1-\alpha\)</span>的情况下，<span class="math display">\[\sqrt{\frac{mn(m + n - 2)}{m + n}}\frac{\overline{x} - \overline{y} - (\mu_1 - \mu_2)}{\sqrt{(m - 1)s_x^2 + (n - 1)s_y^2}} \sim t(m + n - 2)\]</span></p><p>记<span class="math inline">\(s_w^2 = \frac{(m-1)s_x^2 + (n - 1)s_y^2}{m+n-2}\)</span>，<span class="math inline">\(\mu_1 - \mu_2\)</span>的置信区间为<span class="math display">\[[\overline{x} - \overline{y} - \sqrt{\frac{m+n}{mn}}s_wt_{1-\frac{\alpha}{2}}(m+n-2), \overline{x} - \overline{y} + \sqrt{\frac{m+n}{mn}}s_wt_{1-\frac{\alpha}{2}}(m+n-2)]\]</span></p><p>用零售公司的例子，求置信水平为0.95时，<span class="math inline">\(\mu_1 - \mu_2\)</span>的置信区间。</p><ul><li>自定义函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">86.10</span>, <span class="number">71.13</span>, <span class="number">116.25</span>, <span class="number">102.60</span>, <span class="number">97.51</span>, <span class="number">65.39</span>, <span class="number">69.56</span>, <span class="number">70.80</span>, </span><br><span class="line">       <span class="number">83.46</span>, <span class="number">87.27</span>, <span class="number">89.83</span>, <span class="number">80.51</span>, <span class="number">76.78</span>, <span class="number">71.11</span>, <span class="number">90.22</span>, <span class="number">87.55</span>, </span><br><span class="line">       <span class="number">87.60</span>, <span class="number">90.08</span>, <span class="number">101.80</span>, <span class="number">84.96</span>, <span class="number">97.69</span>, <span class="number">66.39</span>, <span class="number">104.06</span>, <span class="number">72.98</span>, </span><br><span class="line">       <span class="number">72.19</span>, <span class="number">91.01</span>, <span class="number">84.36</span>) <span class="comment"># 延长营业时间后的销售额样本</span></span><br><span class="line">y &lt;- c(<span class="number">67.90</span>, <span class="number">76.12</span>, <span class="number">68.64</span>, <span class="number">74.94</span>, <span class="number">63.32</span>, <span class="number">50.43</span>, <span class="number">44.92</span>, <span class="number">64.59</span>, </span><br><span class="line">       <span class="number">61.68</span>, <span class="number">65.01</span>, <span class="number">55.90</span>, <span class="number">54.88</span>, <span class="number">46.78</span>, <span class="number">55.54</span>, <span class="number">67.90</span>, <span class="number">71.62</span>, </span><br><span class="line">       <span class="number">63.00</span>, <span class="number">59.50</span>, <span class="number">63.20</span>, <span class="number">64.86</span>, <span class="number">59.32</span>, <span class="number">53.45</span>, <span class="number">62.51</span>, <span class="number">48.78</span>, </span><br><span class="line">       <span class="number">53.55</span>, <span class="number">59.57</span>, <span class="number">58.62</span>) <span class="comment"># 延长营业时间前的销售额样本</span></span><br><span class="line"><span class="comment"># 置信水平1 - 0.05 = 0.95</span></span><br><span class="line">conf.int &lt;- <span class="keyword">function</span>(x, y, alpha = <span class="number">0.05</span>)&#123;</span><br><span class="line">  m &lt;- length(x) <span class="comment"># 样本x的容量</span></span><br><span class="line">  n &lt;- length(y) <span class="comment"># 样本y的容量</span></span><br><span class="line">  mean.x &lt;- mean(x) <span class="comment"># 样本x的均值</span></span><br><span class="line">  mean.y &lt;- mean(y) <span class="comment"># 样本y的均值</span></span><br><span class="line">  var.x &lt;- var(x) <span class="comment"># 样本x的方差</span></span><br><span class="line">  var.y &lt;- var(y) <span class="comment"># 样本y的方差</span></span><br><span class="line">  df &lt;- m + n - <span class="number">2</span> <span class="comment"># 自由度</span></span><br><span class="line">  quan &lt;- qt(<span class="number">1</span> - alpha / <span class="number">2</span>, df) <span class="comment"># t(m + n - 2)的分位数</span></span><br><span class="line">  sw &lt;- sqrt(((m - <span class="number">1</span>) * var.x + (n - <span class="number">1</span>) * var.y) / (m + n - <span class="number">2</span>))</span><br><span class="line">  radius &lt;- sqrt((m + n) / (m * n)) * sw * quan</span><br><span class="line">  min &lt;- mean.x - mean.y - radius</span><br><span class="line">  max &lt;- mean.x - mean.y + radius</span><br><span class="line">  c(min, max)</span><br><span class="line">&#125;</span><br><span class="line">conf.int(x, y)</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">18.66541</span> <span class="number">30.42051</span></span><br></pre></td></tr></table></figure><ul><li>t.test函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">86.10</span>, <span class="number">71.13</span>, <span class="number">116.25</span>, <span class="number">102.60</span>, <span class="number">97.51</span>, <span class="number">65.39</span>, <span class="number">69.56</span>, <span class="number">70.80</span>, </span><br><span class="line">       <span class="number">83.46</span>, <span class="number">87.27</span>, <span class="number">89.83</span>, <span class="number">80.51</span>, <span class="number">76.78</span>, <span class="number">71.11</span>, <span class="number">90.22</span>, <span class="number">87.55</span>, </span><br><span class="line">       <span class="number">87.60</span>, <span class="number">90.08</span>, <span class="number">101.80</span>, <span class="number">84.96</span>, <span class="number">97.69</span>, <span class="number">66.39</span>, <span class="number">104.06</span>, <span class="number">72.98</span>, </span><br><span class="line">       <span class="number">72.19</span>, <span class="number">91.01</span>, <span class="number">84.36</span>) <span class="comment"># 延长营业时间后的销售额样本</span></span><br><span class="line">y &lt;- c(<span class="number">67.90</span>, <span class="number">76.12</span>, <span class="number">68.64</span>, <span class="number">74.94</span>, <span class="number">63.32</span>, <span class="number">50.43</span>, <span class="number">44.92</span>, <span class="number">64.59</span>, </span><br><span class="line">       <span class="number">61.68</span>, <span class="number">65.01</span>, <span class="number">55.90</span>, <span class="number">54.88</span>, <span class="number">46.78</span>, <span class="number">55.54</span>, <span class="number">67.90</span>, <span class="number">71.62</span>, </span><br><span class="line">       <span class="number">63.00</span>, <span class="number">59.50</span>, <span class="number">63.20</span>, <span class="number">64.86</span>, <span class="number">59.32</span>, <span class="number">53.45</span>, <span class="number">62.51</span>, <span class="number">48.78</span>, </span><br><span class="line">       <span class="number">53.55</span>, <span class="number">59.57</span>, <span class="number">58.62</span>) <span class="comment"># 延长营业时间前的销售额样本</span></span><br><span class="line">ret &lt;- t.test(x, y, var.equal = <span class="literal">TRUE</span>) <span class="comment"># var.equal = TRUE表示方差相等</span></span><br><span class="line">ret$conf.int</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">18.66541</span> <span class="number">30.42051</span></span><br><span class="line">attr(,<span class="string">"conf.level"</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.95</span></span><br></pre></td></tr></table></figure><p>求得置信区间的结果为<span class="math inline">\([18.66541, 30.42051]\)</span>。所得的置信区间结果说明，零售公司延长营业时间后，周营业额明显增加，在0.95的置信水平下，营业额增加的范围是<span class="math inline">\([18.66541, 30.42051]\)</span>。</p><h4 id="fracsigma_22sigma_12-theta已知估计mu_1---mu_2的置信区间"><span class="math inline">\(\frac{\sigma_2^2}{\sigma_1^2} = \theta\)</span>已知，估计<span class="math inline">\(\mu_1 - \mu_2\)</span>的置信区间</h4><p>在置信水平为<span class="math inline">\(1-\alpha\)</span>的情况下，<span class="math display">\[\sqrt{\frac{mn(m+n-2)}{m\theta + n}}\frac{\overline{x} - \overline{y} - (\mu_1 - \mu_2)}{\sqrt{(m - 1)s_x^2 + (n - 1)\frac{s_y^2}{\theta}}} \sim t(m + n - 2)\]</span></p><p>记<span class="math inline">\(s_t^2 = \frac{(m-1)s_x^2 + (n-1)\frac{s_y^2}{\theta}}{m+n-2}\)</span>，<span class="math inline">\(\mu_1 - \mu_2\)</span>的置信区间<span class="math display">\[[\overline{x} - \overline{y} - \sqrt{\frac{m\theta + n}{mn}}s_tt_{1 - \frac{\alpha}{2}}(m+n-2), \overline{x} - \overline{y} + \sqrt{\frac{m\theta + n}{mn}}s_tt_{1 - \frac{\alpha}{2}}(m+n-2)]\]</span></p><p>用零售公司的例子，求置信水平为0.95时，<span class="math inline">\(\mu_1 - \mu_2\)</span>的置信区间。</p><ul><li>自定义函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">86.10</span>, <span class="number">71.13</span>, <span class="number">116.25</span>, <span class="number">102.60</span>, <span class="number">97.51</span>, <span class="number">65.39</span>, <span class="number">69.56</span>, <span class="number">70.80</span>, </span><br><span class="line">       <span class="number">83.46</span>, <span class="number">87.27</span>, <span class="number">89.83</span>, <span class="number">80.51</span>, <span class="number">76.78</span>, <span class="number">71.11</span>, <span class="number">90.22</span>, <span class="number">87.55</span>, </span><br><span class="line">       <span class="number">87.60</span>, <span class="number">90.08</span>, <span class="number">101.80</span>, <span class="number">84.96</span>, <span class="number">97.69</span>, <span class="number">66.39</span>, <span class="number">104.06</span>, <span class="number">72.98</span>, </span><br><span class="line">       <span class="number">72.19</span>, <span class="number">91.01</span>, <span class="number">84.36</span>) <span class="comment"># 延长营业时间后的销售额样本</span></span><br><span class="line">y &lt;- c(<span class="number">67.90</span>, <span class="number">76.12</span>, <span class="number">68.64</span>, <span class="number">74.94</span>, <span class="number">63.32</span>, <span class="number">50.43</span>, <span class="number">44.92</span>, <span class="number">64.59</span>, </span><br><span class="line">       <span class="number">61.68</span>, <span class="number">65.01</span>, <span class="number">55.90</span>, <span class="number">54.88</span>, <span class="number">46.78</span>, <span class="number">55.54</span>, <span class="number">67.90</span>, <span class="number">71.62</span>, </span><br><span class="line">       <span class="number">63.00</span>, <span class="number">59.50</span>, <span class="number">63.20</span>, <span class="number">64.86</span>, <span class="number">59.32</span>, <span class="number">53.45</span>, <span class="number">62.51</span>, <span class="number">48.78</span>, </span><br><span class="line">       <span class="number">53.55</span>, <span class="number">59.57</span>, <span class="number">58.62</span>) <span class="comment"># 延长营业时间前的销售额样本</span></span><br><span class="line"><span class="comment"># 置信水平1 - 0.05 = 0.95</span></span><br><span class="line">conf.int &lt;- <span class="keyword">function</span>(x, y, theta, alpha = <span class="number">0.05</span>)&#123;</span><br><span class="line">  m &lt;- length(x) <span class="comment"># 样本x的容量</span></span><br><span class="line">  n &lt;- length(y) <span class="comment"># 样本y的容量</span></span><br><span class="line">  mean.x &lt;- mean(x) <span class="comment"># 样本x的均值</span></span><br><span class="line">  mean.y &lt;- mean(y) <span class="comment"># 样本y的均值</span></span><br><span class="line">  var.x &lt;- var(x) <span class="comment"># 样本x的方差</span></span><br><span class="line">  var.y &lt;- var(y) <span class="comment"># 样本y的方差</span></span><br><span class="line">  df &lt;- m + n - <span class="number">2</span> <span class="comment"># 自由度</span></span><br><span class="line">  quan &lt;- qt(<span class="number">1</span> - alpha / <span class="number">2</span>, df) <span class="comment"># t(m + n - 2)的分位数</span></span><br><span class="line">  radius &lt;- sqrt((m * theta + n) / (m * n)) * sqrt(((m - <span class="number">1</span>) * var.x + (n - <span class="number">1</span>) * var.y / theta) / (m + n - <span class="number">2</span>)) * quan</span><br><span class="line">  min &lt;- mean.x - mean.y - radius</span><br><span class="line">  max &lt;- mean.x - mean.y + radius</span><br><span class="line">  c(min, max)</span><br><span class="line">&#125;</span><br><span class="line">conf.int(x, y, <span class="number">12</span>/<span class="number">8</span>)</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">18.28586</span> <span class="number">30.80007</span></span><br></pre></td></tr></table></figure><p>求得置信区间的结果为<span class="math inline">\([18.28586, 30.80007]\)</span>。所得的置信区间结果说明，零售公司延长营业时间后，周营业额明显增加，在0.95的置信水平下，营业额增加的范围是<span class="math inline">\([18.28586, 30.80007]\)</span>。</p><h4 id="估计fracsigma_12sigma_22的置信区间">估计<span class="math inline">\(\frac{\sigma_1^2}{\sigma_2^2}\)</span>的置信区间</h4><p>在置信水平为<span class="math inline">\(1-\alpha\)</span>的情况下，<span class="math inline">\(\frac{s_x^2/\sigma_1^2}{s_y^2/\sigma_2^2} \sim F(m-1,n-1)\)</span>，<span class="math inline">\(\frac{\sigma_1^2}{\sigma_2^2}\)</span>的置信区间<span class="math display">\[[\frac{s_x^2}{s_y^2}\frac{1}{F_{1-\frac{\alpha}{2}}(m-1,n-1)}, \quad \frac{s_x^2}{s_y^2}\frac{1}{F_{\frac{\alpha}{2}}(m-1,n-1)}]\]</span></p><p>用零售公司的例子，求置信水平为0.95时，<span class="math inline">\(\frac{\sigma_1^2}{\sigma_2^2}\)</span>的置信区间。</p><ul><li>自定义函数</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">86.10</span>, <span class="number">71.13</span>, <span class="number">116.25</span>, <span class="number">102.60</span>, <span class="number">97.51</span>, <span class="number">65.39</span>, <span class="number">69.56</span>, <span class="number">70.80</span>, </span><br><span class="line">       <span class="number">83.46</span>, <span class="number">87.27</span>, <span class="number">89.83</span>, <span class="number">80.51</span>, <span class="number">76.78</span>, <span class="number">71.11</span>, <span class="number">90.22</span>, <span class="number">87.55</span>, </span><br><span class="line">       <span class="number">87.60</span>, <span class="number">90.08</span>, <span class="number">101.80</span>, <span class="number">84.96</span>, <span class="number">97.69</span>, <span class="number">66.39</span>, <span class="number">104.06</span>, <span class="number">72.98</span>, </span><br><span class="line">       <span class="number">72.19</span>, <span class="number">91.01</span>, <span class="number">84.36</span>) <span class="comment"># 延长营业时间后的销售额样本</span></span><br><span class="line">y &lt;- c(<span class="number">67.90</span>, <span class="number">76.12</span>, <span class="number">68.64</span>, <span class="number">74.94</span>, <span class="number">63.32</span>, <span class="number">50.43</span>, <span class="number">44.92</span>, <span class="number">64.59</span>, </span><br><span class="line">       <span class="number">61.68</span>, <span class="number">65.01</span>, <span class="number">55.90</span>, <span class="number">54.88</span>, <span class="number">46.78</span>, <span class="number">55.54</span>, <span class="number">67.90</span>, <span class="number">71.62</span>, </span><br><span class="line">       <span class="number">63.00</span>, <span class="number">59.50</span>, <span class="number">63.20</span>, <span class="number">64.86</span>, <span class="number">59.32</span>, <span class="number">53.45</span>, <span class="number">62.51</span>, <span class="number">48.78</span>, </span><br><span class="line">       <span class="number">53.55</span>, <span class="number">59.57</span>, <span class="number">58.62</span>) <span class="comment"># 延长营业时间前的销售额样本</span></span><br><span class="line"><span class="comment"># 置信水平1 - 0.05 = 0.95</span></span><br><span class="line">conf.int &lt;- <span class="keyword">function</span>(x, y, alpha = <span class="number">0.05</span>)&#123;</span><br><span class="line">  m &lt;- length(x) <span class="comment"># 样本x的容量</span></span><br><span class="line">  n &lt;- length(y) <span class="comment"># 样本y的容量</span></span><br><span class="line">  df.x &lt;- m - <span class="number">1</span> <span class="comment"># 分子自由度</span></span><br><span class="line">  df.y &lt;- n - <span class="number">1</span> <span class="comment"># 分母自由度</span></span><br><span class="line">  var.x &lt;- var(x) <span class="comment"># 样本x的方差</span></span><br><span class="line">  var.y &lt;- var(y) <span class="comment"># 样本y的方差</span></span><br><span class="line">  min &lt;- var.x/var.y * qf(alpha / <span class="number">2</span>, df.x, df.y) <span class="comment"># 置信区间下限</span></span><br><span class="line">  max &lt;- var.x/var.y * qf(<span class="number">1</span> - alpha / <span class="number">2</span>, df.x, df.y) <span class="comment"># 置信区间上限</span></span><br><span class="line">  c(min, max)</span><br><span class="line">&#125;</span><br><span class="line">conf.int(y, x)</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">0.1772458</span> <span class="number">0.8534348</span></span><br></pre></td></tr></table></figure><ul><li><p>var.test函数</p><p>方差比的区间估计与方差的假设检验密不可分，所以R中的函数var.test()可以用来直接计算两正态总体方差比的置信区间。</p></li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">86.10</span>, <span class="number">71.13</span>, <span class="number">116.25</span>, <span class="number">102.60</span>, <span class="number">97.51</span>, <span class="number">65.39</span>, <span class="number">69.56</span>, <span class="number">70.80</span>, </span><br><span class="line">       <span class="number">83.46</span>, <span class="number">87.27</span>, <span class="number">89.83</span>, <span class="number">80.51</span>, <span class="number">76.78</span>, <span class="number">71.11</span>, <span class="number">90.22</span>, <span class="number">87.55</span>, </span><br><span class="line">       <span class="number">87.60</span>, <span class="number">90.08</span>, <span class="number">101.80</span>, <span class="number">84.96</span>, <span class="number">97.69</span>, <span class="number">66.39</span>, <span class="number">104.06</span>, <span class="number">72.98</span>, </span><br><span class="line">       <span class="number">72.19</span>, <span class="number">91.01</span>, <span class="number">84.36</span>) <span class="comment"># 延长营业时间后的销售额样本</span></span><br><span class="line">y &lt;- c(<span class="number">67.90</span>, <span class="number">76.12</span>, <span class="number">68.64</span>, <span class="number">74.94</span>, <span class="number">63.32</span>, <span class="number">50.43</span>, <span class="number">44.92</span>, <span class="number">64.59</span>, </span><br><span class="line">       <span class="number">61.68</span>, <span class="number">65.01</span>, <span class="number">55.90</span>, <span class="number">54.88</span>, <span class="number">46.78</span>, <span class="number">55.54</span>, <span class="number">67.90</span>, <span class="number">71.62</span>, </span><br><span class="line">       <span class="number">63.00</span>, <span class="number">59.50</span>, <span class="number">63.20</span>, <span class="number">64.86</span>, <span class="number">59.32</span>, <span class="number">53.45</span>, <span class="number">62.51</span>, <span class="number">48.78</span>, </span><br><span class="line">       <span class="number">53.55</span>, <span class="number">59.57</span>, <span class="number">58.62</span>) <span class="comment"># 延长营业时间前的销售额样本</span></span><br><span class="line">ret &lt;- var.test(y, x) <span class="comment"># 默认置信水平为0.95</span></span><br><span class="line">ret$conf.int</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">0.1772458</span> <span class="number">0.8534348</span></span><br><span class="line">attr(,<span class="string">"conf.level"</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.95</span></span><br></pre></td></tr></table></figure><p>求得置信区间的结果为<span class="math inline">\([0.1772458, 0.8534348]\)</span>。所得的置信区间结果说明，零售公司延长营业时间后，周营业额的波动性比较大。</p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/数理统计/" rel="tag"><i class="fa fa-tag"></i> 数理统计</a><a href="/tags/R语言/" rel="tag"><i class="fa fa-tag"></i> R语言</a><a href="/tags/点估计/" rel="tag"><i class="fa fa-tag"></i> 点估计</a><a href="/tags/区间估计/" rel="tag"><i class="fa fa-tag"></i> 区间估计</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/信用风险分析/信用风险分析/" rel="next" title="信用风险分析"><i class="fa fa-chevron-left"></i> 信用风险分析</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/R语言/假设检验及r实现/" rel="prev" title="假设检验及R实现">假设检验及R实现<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">lwl</p><div class="site-description motion-element" itemprop="description"></div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">18</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">7</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">24</span> <span class="site-state-item-name">标签</span></a></div></nav></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#参数估计的r语言实现"><span class="nav-number">1.</span> <span class="nav-text">参数估计的R语言实现</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#概要"><span class="nav-number">1.1.</span> <span class="nav-text">概要</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参数估计"><span class="nav-number">1.2.</span> <span class="nav-text">参数估计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#点估计"><span class="nav-number">1.2.1.</span> <span class="nav-text">点估计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#矩法估计"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">矩法估计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#r语言实现"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">R语言实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#极大似然估计"><span class="nav-number">1.2.2.</span> <span class="nav-text">极大似然估计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#r语言实现-1"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">R语言实现</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#区间估计"><span class="nav-number">1.3.</span> <span class="nav-text">区间估计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#单个正态总体参数的置信区间"><span class="nav-number">1.3.1.</span> <span class="nav-text">单个正态总体参数的置信区间</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#方差sigma已知估计期望mu的置信区间"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">方差\(\sigma\)已知，估计期望\(\mu\)的置信区间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方差sigma未知估计期望mu的置信区间"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">方差\(\sigma\)未知，估计期望\(\mu\)的置信区间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#期望mu未知估计方差sigma2的置信区间"><span class="nav-number">1.3.1.3.</span> <span class="nav-text">期望\(\mu\)未知，估计方差\(\sigma^2\)的置信区间</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两个正态总体下的置信区间"><span class="nav-number">1.3.2.</span> <span class="nav-text">两个正态总体下的置信区间</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#方差sigma_12-sigma_22-sigma2未知估计mu_1---mu_2的置信区间"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">方差\(\sigma_1^2 = \sigma_2^2 = \sigma^2\)未知，估计\(\mu_1 - \mu_2\)的置信区间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fracsigma_22sigma_12-theta已知估计mu_1---mu_2的置信区间"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">\(\frac{\sigma_2^2}{\sigma_1^2} = \theta\)已知，估计\(\mu_1 - \mu_2\)的置信区间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#估计fracsigma_12sigma_22的置信区间"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">估计\(\frac{\sigma_1^2}{\sigma_2^2}\)的置信区间</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2019</span><span class="with-love" id="animate"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">lwl</span></div><div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div> <span class="post-meta-divider">|</span><div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script src="/lib/jquery/index.js?v=3.4.1"></script><script src="/lib/mediumzoom/medium-zoom.min.js"></script><script src="/lib/lazyload/lozad.min.js?v=1.10.0"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/js/utils.js?v=7.3.0"></script><script src="/js/motion.js?v=7.3.0"></script><script src="/js/affix.js?v=7.3.0"></script><script src="/js/schemes/pisces.js?v=7.3.0"></script><script src="/js/scrollspy.js?v=7.3.0"></script><script src="/js/post-details.js?v=7.3.0"></script><script src="/js/next-boot.js?v=7.3.0"></script><script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script><script src="//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="/js/local-search.js?v=7.3.0"></script><script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script><script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script></body></html>