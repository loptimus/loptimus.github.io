<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"><link rel="stylesheet" href="/css/main.css?v=7.1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0"><link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.1.0",sidebar:{position:"left",display:"post",offset:12,onmobile:!1,dimmer:!1},back2top:!0,back2top_sidebar:!1,fancybox:!1,fastclick:!1,lazyload:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta name="description" content="收入分析—RFM模型 RFM模型是基于客户的消费行为，将用户在三个维度上进行分类，为公司营销决策提供依据。RFM模型通过客户的最近付费时间间隔（R，Recency） 、付费总次数（F，Frequency）和付费总金额（M，Monetary）三项指标衡量客户价值。"><meta name="keywords" content="Python"><meta property="og:type" content="article"><meta property="og:title" content="收入分析—RFM模型"><meta property="og:url" content="http://yoursite.com/游戏数据分析/收入分析—rfm模型/index.html"><meta property="og:site_name" content="QuickNotes"><meta property="og:description" content="收入分析—RFM模型 RFM模型是基于客户的消费行为，将用户在三个维度上进行分类，为公司营销决策提供依据。RFM模型通过客户的最近付费时间间隔（R，Recency） 、付费总次数（F，Frequency）和付费总金额（M，Monetary）三项指标衡量客户价值。"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://yoursite.com/images/收入分析-RFM模型/bar.png"><meta property="og:updated_time" content="2019-07-02T11:34:47.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="收入分析—RFM模型"><meta name="twitter:description" content="收入分析—RFM模型 RFM模型是基于客户的消费行为，将用户在三个维度上进行分类，为公司营销决策提供依据。RFM模型通过客户的最近付费时间间隔（R，Recency） 、付费总次数（F，Frequency）和付费总金额（M，Monetary）三项指标衡量客户价值。"><meta name="twitter:image" content="http://yoursite.com/images/收入分析-RFM模型/bar.png"><link rel="canonical" href="http://yoursite.com/游戏数据分析/收入分析—rfm模型/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>收入分析—RFM模型 | QuickNotes</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">QuickNotes</span><span class="logo-line-after"><i></i></span></a></div></div><div class="site-nav-toggle"> <button aria-label="切换导航栏"><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>公益 404</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header> <a href="https://github.com/loptimus" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://yoursite.com/游戏数据分析/收入分析—rfm模型/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lwl"><meta itemprop="description" content><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="QuickNotes"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">收入分析—RFM模型</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-06-01 19:34:47" itemprop="dateCreated datePublished" datetime="2019-06-01T19:34:47+08:00">2019-06-01</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2019-07-02 19:34:47" itemprop="dateModified" datetime="2019-07-02T19:34:47+08:00">2019-07-02</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/游戏数据分析/" itemprop="url" rel="index"><span itemprop="name">游戏数据分析</span></a></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i> 阅读次数：<span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span title="本文字数">5.4k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">5 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="收入分析rfm模型">收入分析—RFM模型</h1><p>RFM模型是基于客户的消费行为，将用户在三个维度上进行分类，为公司营销决策提供依据。RFM模型通过客户的最近付费时间间隔（R，Recency） 、付费总次数（F，Frequency）和付费总金额（M，Monetary）三项指标衡量客户价值。</p><a id="more"></a><ul><li>R表示距离客户最近一次付费日期有多久，R值越低，客户价值越高；</li><li>F表示客户的购买频率，即一段时间内客户发生交易的次数，F值越高，客户的价值越高；</li><li>M表示客户在公司的消费金额，是一段时间内利润的度量，M值越高，客户的价值越高。</li></ul><p>R的计算可以用天数表示，即R = 统计截止日期 - 每个用户最后一次消费的日期，其中可以使用统计期间内所有用户中最后一次交易的时间作为统计的截止日期。</p><p>通过这三个指标对客户的价值进行划分：</p><table><thead><tr class="header"><th style="text-align:left">客户类型</th><th style="text-align:left">客户特征</th></tr></thead><tbody><tr class="odd"><td style="text-align:left">重要价值客户</td><td style="text-align:left">消费金额大、消费频率高、最近一次消费时间间隔短，优质客户，需要保持</td></tr><tr class="even"><td style="text-align:left">重要发展客户</td><td style="text-align:left">消费金额大，消费频率低，最近一次消费时间间隔短，深耕客户，需要重点识别</td></tr><tr class="odd"><td style="text-align:left">重要挽留客户</td><td style="text-align:left">消费金额大，消费频率高，但最近无消费，有价值客户，需要挽留</td></tr><tr class="even"><td style="text-align:left">一般挽留客户</td><td style="text-align:left">消费金额大，消费频率低，最近无消费，潜在的有价值客户，需要挽留</td></tr><tr class="odd"><td style="text-align:left">一般保持客户</td><td style="text-align:left">消费金额小，消费频率高，最近一次消费时间间隔短，潜力客户，需要挖掘</td></tr><tr class="even"><td style="text-align:left">新客户</td><td style="text-align:left">消费金额小，消费频率低，最近一次消费时间间隔短，新客户，有推广价值</td></tr><tr class="odd"><td style="text-align:left">一般价值客户</td><td style="text-align:left">消费金额小，消费频率高，最近无消费，一般维持客户</td></tr><tr class="even"><td style="text-align:left">低价值客户</td><td style="text-align:left">消费金额小，消费频率低，最近无消费，低价值客户</td></tr></tbody></table><h2 id="付费用户rfm模型分析">付费用户RFM模型分析</h2><p>现有某一款游戏最近一周的付费类数据，其中包括本周最后一次付费日期、付费次数、付费金额等。利用该数据进行付费用户RFM模型分析。</p><p>载入分析所需的库</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib.cm <span class="keyword">as</span> cm</span><br><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'SimHei'</span>]  <span class="comment"># 显示图形中的中文标签</span></span><br></pre></td></tr></table></figure><p>导入数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">"用户消费数据.csv"</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure><table><thead><tr class="header"><th style="text-align:center"></th><th style="text-align:center">player_id</th><th style="text-align:center">last_date</th><th style="text-align:center">pay_cnt</th><th style="text-align:center">pay_mnt</th></tr></thead><tbody><tr class="odd"><td style="text-align:center">0</td><td style="text-align:center">1</td><td style="text-align:center">20161002</td><td style="text-align:center">2</td><td style="text-align:center">48.0</td></tr><tr class="even"><td style="text-align:center">1</td><td style="text-align:center">2</td><td style="text-align:center">20161002</td><td style="text-align:center">2</td><td style="text-align:center">7.0</td></tr><tr class="odd"><td style="text-align:center">2</td><td style="text-align:center">3</td><td style="text-align:center">20161002</td><td style="text-align:center">1</td><td style="text-align:center">6.0</td></tr><tr class="even"><td style="text-align:center">3</td><td style="text-align:center">4</td><td style="text-align:center">20160927</td><td style="text-align:center">2</td><td style="text-align:center">31.0</td></tr><tr class="odd"><td style="text-align:center">4</td><td style="text-align:center">5</td><td style="text-align:center">20160928</td><td style="text-align:center">1</td><td style="text-align:center">6.0</td></tr></tbody></table><p>查看数据结果明细</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">pandas</span>.<span class="title">core</span>.<span class="title">frame</span>.<span class="title">DataFrame</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">RangeIndex</span>:</span> <span class="number">3782</span> entries, <span class="number">0</span> to <span class="number">3781</span></span><br><span class="line">Data columns (total <span class="number">4</span> columns):</span><br><span class="line">player_id    <span class="number">3782</span> non-null int64</span><br><span class="line">last_date    <span class="number">3782</span> non-null int64</span><br><span class="line">pay_cnt      <span class="number">3782</span> non-null int64</span><br><span class="line">pay_mnt      <span class="number">3782</span> non-null float64</span><br><span class="line">dtypes: float64(<span class="number">1</span>), int64(<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>数据说明：</p><ul><li>player_id表示玩家ID；</li><li>last_date表示最后一次付费日期；</li><li>pay_cnt表示付费次数；</li><li>pay_mnt表示付费金额。</li></ul><p>计算用户最近一次付费时间间隔</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将last_date转换成日期格式</span></span><br><span class="line">df[<span class="string">'last_date'</span>] = pd.to_datetime(df[<span class="string">'last_date'</span>].astype(str))</span><br><span class="line"><span class="comment"># 计算RFM中的R，即最后一次消费日期的时间间隔，用天数表示</span></span><br><span class="line">df[<span class="string">'time_interval'</span>] = (max(df[<span class="string">'last_date'</span>]) - df[<span class="string">'last_date'</span>]).dt.days</span><br></pre></td></tr></table></figure><p>查看付费时间间隔（R）、付费次数（F）及付费金额（M）的分位数情况</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[[<span class="string">"time_interval"</span>, <span class="string">"pay_cnt"</span>, <span class="string">"pay_mnt"</span>]].quantile(np.arange(<span class="number">0</span>, <span class="number">1.1</span>, <span class="number">0.1</span>))</span><br></pre></td></tr></table></figure><table><thead><tr class="header"><th style="text-align:center"></th><th style="text-align:center">time_interval</th><th style="text-align:center">pay_cnt</th><th style="text-align:center">pay_mnt</th></tr></thead><tbody><tr class="odd"><td style="text-align:center">0.0</td><td style="text-align:center">0.0</td><td style="text-align:center">1.0</td><td style="text-align:center">0.03</td></tr><tr class="even"><td style="text-align:center">0.1</td><td style="text-align:center">0.0</td><td style="text-align:center">1.0</td><td style="text-align:center">1.00</td></tr><tr class="odd"><td style="text-align:center">0.2</td><td style="text-align:center">0.0</td><td style="text-align:center">1.0</td><td style="text-align:center">1.00</td></tr><tr class="even"><td style="text-align:center">0.3</td><td style="text-align:center">0.0</td><td style="text-align:center">1.0</td><td style="text-align:center">6.00</td></tr><tr class="odd"><td style="text-align:center">0.4</td><td style="text-align:center">0.0</td><td style="text-align:center">1.0</td><td style="text-align:center">6.00</td></tr><tr class="even"><td style="text-align:center">0.5</td><td style="text-align:center">0.0</td><td style="text-align:center">1.0</td><td style="text-align:center">6.00</td></tr><tr class="odd"><td style="text-align:center">0.6</td><td style="text-align:center">0.0</td><td style="text-align:center">1.0</td><td style="text-align:center">7.00</td></tr><tr class="even"><td style="text-align:center">0.7</td><td style="text-align:center">0.0</td><td style="text-align:center">2.0</td><td style="text-align:center">18.00</td></tr><tr class="odd"><td style="text-align:center">0.8</td><td style="text-align:center">1.0</td><td style="text-align:center">2.0</td><td style="text-align:center">30.00</td></tr><tr class="even"><td style="text-align:center">0.9</td><td style="text-align:center">2.0</td><td style="text-align:center">3.0</td><td style="text-align:center">57.00</td></tr><tr class="odd"><td style="text-align:center">1.0</td><td style="text-align:center">6.0</td><td style="text-align:center">42.0</td><td style="text-align:center">11206.00</td></tr></tbody></table><p>从分位数的结果来看，付费时间间隔（R）、付费次数（F）及付费金额（M）都存在明显的左偏现象，所以不宜使用平均数的方法选择基准值。根据分位数的结果，R的基准值选择70%分位数0天，F的基准值选择60%分位数的1次，M的基准值选择50%分位数的6元。选定基准值后，可以使用者这三个基准值对用户进行分类。为了便于处理，可以引入3个衍生变量：tagR、tagF、tagM。当值大于基准时，tagR为0，tagF、tagM为1，当值小于等于基准值时，tagR为1，tagF、tagM为0。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'tagR'</span>] = np.where(df[<span class="string">'time_interval'</span>] &lt;= <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">df[<span class="string">'tagF'</span>] = np.where(df[<span class="string">'pay_cnt'</span>] &lt;= <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">df[<span class="string">'tagM'</span>] = np.where(df[<span class="string">'pay_mnt'</span>] &lt;= <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>根据RFM模型进行分类，给每位用户打上相应的类型标签，统计不同RFM类型的用户人数和付费金额，并绘制柱形图。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为所有用户打上标签</span></span><br><span class="line">df[<span class="string">'type'</span>] = <span class="string">"一般挽留客户"</span></span><br><span class="line">df.loc[(df[<span class="string">'tagR'</span>] == <span class="number">1</span>) &amp; (df[<span class="string">'tagF'</span>] == <span class="number">1</span>) &amp; (df[<span class="string">'tagM'</span>] == <span class="number">1</span>), <span class="string">"type"</span>] = <span class="string">"重要价值客户"</span></span><br><span class="line">df.loc[(df[<span class="string">'tagR'</span>] == <span class="number">1</span>) &amp; (df[<span class="string">'tagF'</span>] == <span class="number">0</span>) &amp; (df[<span class="string">'tagM'</span>] == <span class="number">1</span>), <span class="string">"type"</span>] = <span class="string">"重要发展客户"</span></span><br><span class="line">df.loc[(df[<span class="string">'tagR'</span>] == <span class="number">0</span>) &amp; (df[<span class="string">'tagF'</span>] == <span class="number">1</span>) &amp; (df[<span class="string">'tagM'</span>] == <span class="number">1</span>), <span class="string">"type"</span>] = <span class="string">"重要挽留客户"</span></span><br><span class="line">df.loc[(df[<span class="string">'tagR'</span>] == <span class="number">1</span>) &amp; (df[<span class="string">'tagF'</span>] == <span class="number">1</span>) &amp; (df[<span class="string">'tagM'</span>] == <span class="number">0</span>), <span class="string">"type"</span>] = <span class="string">"一般保持客户"</span></span><br><span class="line">df.loc[(df[<span class="string">'tagR'</span>] == <span class="number">1</span>) &amp; (df[<span class="string">'tagF'</span>] == <span class="number">0</span>) &amp; (df[<span class="string">'tagM'</span>] == <span class="number">0</span>), <span class="string">"type"</span>] = <span class="string">"新客户"</span></span><br><span class="line">df.loc[(df[<span class="string">'tagR'</span>] == <span class="number">0</span>) &amp; (df[<span class="string">'tagF'</span>] == <span class="number">1</span>) &amp; (df[<span class="string">'tagM'</span>] == <span class="number">0</span>), <span class="string">"type"</span>] = <span class="string">"一般价值客户"</span></span><br><span class="line">df.loc[(df[<span class="string">'tagR'</span>] == <span class="number">0</span>) &amp; (df[<span class="string">'tagF'</span>] == <span class="number">0</span>) &amp; (df[<span class="string">'tagM'</span>] == <span class="number">0</span>), <span class="string">"type"</span>] = <span class="string">"低价值客户"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按用户类型分组</span></span><br><span class="line">grouped = df.groupby(<span class="string">'type'</span>)</span><br><span class="line"><span class="comment"># 对分组后的各组的play_id去重后计数，并重命名</span></span><br><span class="line">usr_cnt = grouped.player_id.nunique().rename(<span class="string">"usr_cnt"</span>)</span><br><span class="line"><span class="comment"># 对分组后的各组的pay_mnt求和，并重命名</span></span><br><span class="line">pay_mnt_sum = grouped.pay_mnt.sum().rename(<span class="string">"pay_mnt_sum"</span>)</span><br><span class="line"><span class="comment"># 合并统计数据usr_cnt，pay_mnt_sum到同一个DataFrame中</span></span><br><span class="line">df_stats = pd.concat([usr_cnt, pay_mnt_sum], axis=<span class="number">1</span>).reset_index()</span><br><span class="line"><span class="comment"># 按照付费金额进行降序排列</span></span><br><span class="line">df_stats = df_stats.sort_values(by=<span class="string">"pay_mnt_sum"</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算各分组人数所占总体人数的比例</span></span><br><span class="line">df_stats[<span class="string">"usr_cnt_rate"</span>] = round(</span><br><span class="line">  df_stats[<span class="string">"usr_cnt"</span>] / np.sum(df_stats[<span class="string">"usr_cnt"</span>]), <span class="number">2</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># 计算各分组消费金额占总体消费金额的比例</span></span><br><span class="line">df_stats[<span class="string">"pay_mnt_sum_rate"</span>] = round(</span><br><span class="line">  df_stats[<span class="string">"pay_mnt_sum"</span>] / np.sum(df_stats[<span class="string">"pay_mnt_sum"</span>]), <span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>查看上述的统计数据</p><table><thead><tr class="header"><th style="text-align:center"></th><th style="text-align:center">type</th><th style="text-align:center">usr_cnt</th><th style="text-align:center">pay_mnt_sum</th><th style="text-align:center">usr_cnt_rate</th><th style="text-align:center">pay_mnt_sum_rate</th></tr></thead><tbody><tr class="odd"><td style="text-align:center">5</td><td style="text-align:center">重要价值客户</td><td style="text-align:center">1098</td><td style="text-align:center">143775.00</td><td style="text-align:center">0.2903</td><td style="text-align:center">0.8124</td></tr><tr class="even"><td style="text-align:center">6</td><td style="text-align:center">重要发展客户</td><td style="text-align:center">378</td><td style="text-align:center">16717.00</td><td style="text-align:center">0.0999</td><td style="text-align:center">0.0945</td></tr><tr class="odd"><td style="text-align:center">7</td><td style="text-align:center">重要挽留客户</td><td style="text-align:center">231</td><td style="text-align:center">7567.00</td><td style="text-align:center">0.0611</td><td style="text-align:center">0.0428</td></tr><tr class="even"><td style="text-align:center">4</td><td style="text-align:center">新客户</td><td style="text-align:center">1259</td><td style="text-align:center">4609.00</td><td style="text-align:center">0.3329</td><td style="text-align:center">0.0260</td></tr><tr class="odd"><td style="text-align:center">2</td><td style="text-align:center">一般挽留客户</td><td style="text-align:center">41</td><td style="text-align:center">2072.00</td><td style="text-align:center">0.0108</td><td style="text-align:center">0.0117</td></tr><tr class="even"><td style="text-align:center">3</td><td style="text-align:center">低价值客户</td><td style="text-align:center">601</td><td style="text-align:center">1876.00</td><td style="text-align:center">0.1589</td><td style="text-align:center">0.0106</td></tr><tr class="odd"><td style="text-align:center">1</td><td style="text-align:center">一般保持客户</td><td style="text-align:center">120</td><td style="text-align:center">243.00</td><td style="text-align:center">0.0317</td><td style="text-align:center">0.0014</td></tr><tr class="even"><td style="text-align:center">0</td><td style="text-align:center">一般价值客户</td><td style="text-align:center">54</td><td style="text-align:center">106.03</td><td style="text-align:center">0.0143</td><td style="text-align:center">0.0006</td></tr></tbody></table><p>绘制付费金额统计、付费人数统计柱形图</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure(dpi=<span class="number">100</span>, figsize=(<span class="number">10</span>,<span class="number">8</span>))</span><br><span class="line"><span class="comment"># 选择柱形图颜色</span></span><br><span class="line">type_len = len(df_stats[<span class="string">"type"</span>].unique())</span><br><span class="line">colors = cm.rainbow(np.linspace(<span class="number">0</span>, <span class="number">1</span>, type_len))</span><br><span class="line"></span><br><span class="line">ax_pay = fig.add_subplot(<span class="number">211</span>)</span><br><span class="line">ax_pay.bar(df_stats[<span class="string">"type"</span>], df_stats[<span class="string">"pay_mnt_sum_rate"</span>], color=colors)</span><br><span class="line">ax_pay.set_title(<span class="string">"RFM付费金额比例"</span>)</span><br><span class="line"></span><br><span class="line">ax_usr = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line">ax_usr.bar(df_stats[<span class="string">"type"</span>], df_stats[<span class="string">"usr_cnt_rate"</span>], color=colors)</span><br><span class="line">ax_usr.set_title(<span class="string">"RFM付费人数比例"</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="../../images/收入分析-RFM模型/bar.png"></p><p>通过上述图表可以看到:</p><ul><li>重要价值客户占了全部付费用户人数的29.03%，贡献了81.24%的收入，他们是收入的主要来源，需重点维护。</li><li>新用户占了全部付费人数的33.29%，但是付费金额只占到2.6%。对于这类用户，可以给他们推荐新的玩法和角色，更进一步激发他们的付费能力。</li><li>重要发展客户占付费人数的9.99%，付费金额占9.45%；重要挽留客户占付费人数的6.11%，付费金额占4.28%。对于这两类客户来说，他们可能有一定的付费能力，需要进一步挖掘，分析用户的消费行为，制定有针对性的消费策略。</li><li>对于其他分类用户，他们可能付费能力有限，而更关注一些超值大礼包，因此，做运营活动促销时可以对他们进行推广和刺激，提高整体付费渗透率。</li></ul><h2 id="rfm的不足及改进">RFM的不足及改进</h2><p>RFM模型分析虽然简单有效，但也存在一定的不足。</p><h3 id="不足">不足</h3><ul><li>用户评分过于简单：评分标准是根据选择的基准值划分用户群，而该基准值的选择容易受到分析者主观经验的影响。</li><li>用户行为变化无法追踪：RFM模型仅仅是利用统计周期内的数据对指标进行分级，无法体现用户的以前行为，不能发现用户不同时期的状态变化。</li><li>指标间的相互影响：在统计周期内的消费频率（F）和消费金额（M）两个指标存在共线性问题。</li></ul><h3 id="改进">改进</h3><ul><li>用户分群：利用聚类分析对用户进行划分，可以分为超R、大R、中R、小R等。</li><li>更多维度描述用户：可以增加用户的历史付费总次数、历史付费总金额、周平均付费金额等指标，利用相关性分析查看各变量间的关系。</li><li>数据降维：利用主成分分析进行降维处理，消除各指标间的线性影响。</li><li>运营策略支持：运营可以利用用户分群进行精细化运营，甚至可以结合关联推荐、智能推荐系统发现不同用户群的购物习惯，对道具进行捆绑打折销售，或者利用协同过滤的推荐算法对个体玩家进行个性化推荐。</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/游戏数据分析/渠道分析—用户忠诚度/" rel="next" title="渠道分析—用户忠诚度"><i class="fa fa-chevron-left"></i> 渠道分析—用户忠诚度</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"></div></div></footer></div></article></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">lwl</p><div class="site-description motion-element" itemprop="description"></div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">18</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">7</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">24</span> <span class="site-state-item-name">标签</span></a></div></nav></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#收入分析rfm模型"><span class="nav-number">1.</span> <span class="nav-text">收入分析—RFM模型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#付费用户rfm模型分析"><span class="nav-number">1.1.</span> <span class="nav-text">付费用户RFM模型分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rfm的不足及改进"><span class="nav-number">1.2.</span> <span class="nav-text">RFM的不足及改进</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#不足"><span class="nav-number">1.2.1.</span> <span class="nav-text">不足</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#改进"><span class="nav-number">1.2.2.</span> <span class="nav-text">改进</span></a></li></ol></li></ol></li></ol></div></div></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; <span itemprop="copyrightYear">2019</span><span class="with-love" id="animate"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">lwl</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span title="站点总字数">164k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span title="站点阅读时长">2:29</span></div><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_uv">本站访客数:<span id="busuanzi_value_site_uv">&nbsp;</span></span></div><div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div> <span class="post-meta-divider">|</span><div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/js/utils.js?v=7.1.0"></script><script src="/js/motion.js?v=7.1.0"></script><script src="/js/affix.js?v=7.1.0"></script><script src="/js/schemes/pisces.js?v=7.1.0"></script><script src="/js/scrollspy.js?v=7.1.0"></script><script src="/js/post-details.js?v=7.1.0"></script><script src="/js/next-boot.js?v=7.1.0"></script><script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script><script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script></body></html>